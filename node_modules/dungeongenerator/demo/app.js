'use strict'

const ColorHash = require('color-hash')
const color = new ColorHash()

let place = $('.container')
const DungeonGenerator = require('../');

const drawMaze = (h, w, rooms, roomSize, place) => {
    let dungeon = new DungeonGenerator(h, w, rooms, roomSize)

    const block_width = (place.width() - 1.0) / w

    place.html('')
    dungeon.maze.forEach((row) => {
        row.forEach((c) => {
            const block_color = c > 0 ? color.hex(c + 1) : '';
            const block = $('<div/>')
                        .addClass('basic-block')
                        .css('background-color', block_color)
                        .css('width', block_width)
                        .css('height', block_width)
            place.append(block)
        })
        let block = $('<div/>').addClass('clear')
        place.append(block)
    })
}

$(document).ready(() =>{
    $('input').on('change', () => {
        drawMaze(
            $('.val_h').val(),
            $('.val_w').val(), 
            $('.val_rooms').val(), 
            $('.val_room_size').val(), 
            place
        )
    })
    drawMaze(
        $('.val_h').val(),
        $('.val_w').val(), 
        $('.val_rooms').val(), 
        $('.val_room_size').val(), 
        place
    )
})
